/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package test;

import com.couchbase.client.java.Bucket;
import com.couchbase.client.java.Cluster;
import com.couchbase.client.java.CouchbaseCluster;
import com.couchbase.client.java.cluster.ClusterManager;
import com.couchbase.client.java.document.json.JsonObject;
import com.couchbase.client.java.query.N1qlQuery;
import com.couchbase.client.java.query.N1qlQueryResult;

/**
 *
 * @author nickc
 */
public class TestJsonObject {
    
    String jsonString = "{\n" +
"  \"medallion\": \"002B4CFC5B8920A87065FC131F9732D1\",\n" +
"  \"surcharge\": \"0.5\",\n" +
"  \"fare_amount\": \"13.5\",\n" +
"  \"pickup_longitude\": \"-73.969421\",\n" +
"  \"pickup_datetime\": \"2013-01-13 04:35asdf\",\n" +
"  \"passenger_count\": \"1\",\n" +
"  \"tolls_amount\": \"0\",\n" +
"  \"trip_time_in_secs\": \"660\",\n" +
"  \"dropoff_latitude\": \"40.769043\",\n" +
"  \"rate_code\": \"1\",\n" +
"  \"trip_distance\": \"3.9\",\n" +
"  \"payment_type\": \"CSH\",\n" +
"  \"dropoff_longitude\": \"-73.925873\",\n" +
"  \"credit_card\": \"\",\n" +
"  \"credit_card_type\": \"n/a\",\n" +
"  \"total_amount\": \"14.5\",\n" +
"  \"pickup_latitude\": \"40.763699\",\n" +
"  \"hack_license\": \"DD63AD6504C4A40A301AEE0C5CE41C28\",\n" +
"  \"vendor_id\": \"VTS\",\n" +
"  \"tip_amount\": \"0\",\n" +
"  \"mta_tax\": \"0.5\",\n" +
"  \"dropoff_datetime\": \"2013-01-13 04:46asdf\"\n" +
"}";
    
    public static void main(String[] argu) {
        
        new TestJsonObject();
        
    }
    
    public TestJsonObject() {
        test();
    }
    
    public void test() {
        JsonObject json = JsonObject.fromJson(jsonString);
        processJsonObject(json);
        
    }
    
    private void processJsonObject(JsonObject jsonObject) {
        /*
        //Get Field Names from JSON
        Set<String> fieldNames = jsonObject.getNames();
        Iterator<String> fieldNamesInt = fieldNames.iterator();
        
        //Loop throught and get names
        while (fieldNamesInt.hasNext()) {
            String fieldName = fieldNamesInt.next();
            String fieldValue = jsonObject.getString(fieldName);
            System.out.println(fieldName + " - " + fieldValue);
        }*/
        
                //Connect to Couchbase Cluster
        Cluster cluster = CouchbaseCluster.create();
        ClusterManager clusterManager = cluster.clusterManager("Administrator", "couchbase");
        
        //Now lets open the bucket
        Bucket bucket = cluster.openBucket("CreditCards");
        
         // Perform a N1QL Query
        N1qlQueryResult result = bucket.query(N1qlQuery.simple("SELECT * FROM CreditCards"));
        
        System.out.println(result.allRows().size());
        
        
        
        
        
        
    }
    
    
   
    
}
